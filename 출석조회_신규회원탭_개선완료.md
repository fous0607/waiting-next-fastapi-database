# ì¶œì„ ì¡°íšŒ í™”ë©´ ì‹ ê·œíšŒì› íƒ­ ê°œì„  ì™„ë£Œ

## ìš”ì²­ ì‚¬í•­

1. **ì‹ ê·œíšŒì› íƒ­ ë°ì´í„° í‘œì‹œ ê°œì„ **
   - ì‹ ê·œíšŒì› íƒ­ë„ ì¶œì„í˜„í™©ì²˜ëŸ¼ ë°ì´í„°ë¥¼ ë³´ì—¬ì£¼ê¸°
   - ì‹ ê·œíšŒì› ë¦¬ìŠ¤íŠ¸ë¥¼ ì¶œì„ìˆœìœ¼ë¡œ ë‚˜ì—´

2. **ê¸°ë³¸ íƒ­ ë³€ê²½**
   - í˜„ì¬: ì¶œì„í˜„í™© íƒ­ì´ ê¸°ë³¸ ì„ íƒ
   - ë³€ê²½: ëŒ€ê¸° í˜„í™© íƒ­ì´ ê¸°ë³¸ ì„ íƒë˜ë„ë¡

## ìˆ˜ì • ë‚´ìš©

### 1. ë°±ì—”ë“œ API ìˆ˜ì • - [routers/attendance.py](routers/attendance.py:310-360)

#### `/api/attendance/new-members` ì—”ë“œí¬ì¸íŠ¸ ê°œì„ 

**Before (ê¸°ì¡´):**
```python
# ê°€ì…ì¼ ê¸°ì¤€ ì •ë ¬
new_members = db.query(Member).filter(...).order_by(desc(Member.created_at)).all()

# ìµœì´ˆ ì¶œì„ì¼ë§Œ ì¡°íšŒ
for member in new_members:
    first_attendance = db.query(WaitingList).filter(...).first()
    result.append({
        "name": member.name,
        "phone": member.phone,
        "joined_at": member.created_at.strftime("%Y-%m-%d"),
        "first_attendance": first_attendance.attended_at.strftime("%Y-%m-%d") if first_attendance else None
    })

return {
    "count": len(new_members),
    "members": result
}
```

**After (ê°œì„ ):**
```python
# ê°€ì…ì¼ í•„í„°ë§ë§Œ (ì •ë ¬ì€ ë‚˜ì¤‘ì—)
new_members = db.query(Member).filter(...).all()

result = []
total_attendance = 0

for member in new_members:
    # âœ… ì¶œì„ íšŸìˆ˜ ì¡°íšŒ
    attendance_count = db.query(func.count(WaitingList.id)).filter(
        WaitingList.member_id == member.id,
        WaitingList.status == 'attended'
    ).scalar() or 0

    # ìµœì´ˆ ì¶œì„ì¼ ì¡°íšŒ
    first_attendance = db.query(WaitingList).filter(...).first()

    # âœ… ìµœê·¼ ì¶œì„ì¼ ì¡°íšŒ
    last_attendance = db.query(WaitingList).filter(
        WaitingList.member_id == member.id,
        WaitingList.status == 'attended'
    ).order_by(desc(WaitingList.attended_at)).first()

    total_attendance += attendance_count

    result.append({
        "name": member.name,
        "phone": member.phone,
        "joined_at": member.created_at.strftime("%Y-%m-%d"),
        "first_attendance": first_attendance.attended_at.strftime("%Y-%m-%d") if first_attendance else None,
        "last_attendance": last_attendance.attended_at.strftime("%Y-%m-%d") if last_attendance else None,
        "attendance_count": attendance_count  # âœ… ì¶œì„ íšŸìˆ˜ ì¶”ê°€
    })

# âœ… ì¶œì„ìˆœìœ¼ë¡œ ì •ë ¬ (ì¶œì„ íšŸìˆ˜ê°€ ë§ì€ ìˆœ)
result.sort(key=lambda x: x['attendance_count'], reverse=True)

# âœ… í‰ê·  ì¶œì„ íšŸìˆ˜ ê³„ì‚°
avg_attendance = round(total_attendance / len(new_members), 1) if new_members else 0

return {
    "count": len(new_members),
    "total_attendance": total_attendance,      # âœ… ì´ ì¶œì„ íšŸìˆ˜
    "avg_attendance": avg_attendance,          # âœ… í‰ê·  ì¶œì„ íšŸìˆ˜
    "members": result
}
```

**ì£¼ìš” ê°œì„  ì‚¬í•­:**
- âœ… ê° íšŒì›ì˜ **ì¶œì„ íšŸìˆ˜** ì¡°íšŒ ë° ë°˜í™˜
- âœ… ê° íšŒì›ì˜ **ìµœê·¼ ì¶œì„ì¼** ì¡°íšŒ ë° ë°˜í™˜
- âœ… **ì¶œì„ìˆœìœ¼ë¡œ ì •ë ¬** (ì¶œì„ íšŸìˆ˜ ë‚´ë¦¼ì°¨ìˆœ)
- âœ… **ì´ ì¶œì„ íšŸìˆ˜** ê³„ì‚° ë° ë°˜í™˜
- âœ… **í‰ê·  ì¶œì„ íšŸìˆ˜** ê³„ì‚° ë° ë°˜í™˜

### 2. í”„ë¡ íŠ¸ì—”ë“œ ìˆ˜ì • - [templates/attendance.html](templates/attendance.html)

#### 2-1. í†µê³„ ì¹´ë“œ ì¶”ê°€ (lines 331-344)

**Before:**
```html
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-label">ì‹ ê·œ ê°€ì… íšŒì›</div>
        <div class="stat-value" id="newMemberCount">0ëª…</div>
    </div>
</div>
```

**After:**
```html
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-label">ì‹ ê·œ ê°€ì… íšŒì›</div>
        <div class="stat-value" id="newMemberCount">0ëª…</div>
    </div>
    <!-- âœ… ì´ ì¶œì„ íšŸìˆ˜ ì¹´ë“œ ì¶”ê°€ -->
    <div class="stat-card">
        <div class="stat-label">ì´ ì¶œì„ íšŸìˆ˜</div>
        <div class="stat-value" style="color: #3498db;" id="newMemberTotalAttendance">0íšŒ</div>
    </div>
    <!-- âœ… í‰ê·  ì¶œì„ íšŸìˆ˜ ì¹´ë“œ ì¶”ê°€ -->
    <div class="stat-card">
        <div class="stat-label">í‰ê·  ì¶œì„ íšŸìˆ˜</div>
        <div class="stat-value" style="color: #9b59b6;" id="newMemberAvgAttendance">0íšŒ</div>
    </div>
</div>
```

#### 2-2. í…Œì´ë¸” êµ¬ì¡° ë³€ê²½ (lines 346-361)

**Before:**
```html
<table class="data-table">
    <thead>
        <tr>
            <th>ê°€ì…ì¼ì‹œ</th>
            <th>ì´ë¦„</th>
            <th>ì „í™”ë²ˆí˜¸</th>
            <th>ìµœì´ˆ ì¶œì„ì¼</th>
        </tr>
    </thead>
    <tbody id="newMemberList"></tbody>
</table>
```

**After:**
```html
<table class="data-table">
    <thead>
        <tr>
            <th width="80">ìˆœìœ„</th>           <!-- âœ… ìˆœìœ„ ì¶”ê°€ -->
            <th>ì´ë¦„</th>
            <th>ì „í™”ë²ˆí˜¸</th>
            <th>ì¶œì„ íšŸìˆ˜</th>                 <!-- âœ… ì¶œì„ íšŸìˆ˜ ì¶”ê°€ -->
            <th>ê°€ì…ì¼</th>
            <th>ìµœì´ˆ ì¶œì„ì¼</th>
            <th>ìµœê·¼ ì¶œì„ì¼</th>                <!-- âœ… ìµœê·¼ ì¶œì„ì¼ ì¶”ê°€ -->
        </tr>
    </thead>
    <tbody id="newMemberList"></tbody>
</table>
```

#### 2-3. loadNewMembers() í•¨ìˆ˜ ê°œì„  (lines 658-693)

**Before:**
```javascript
async function loadNewMembers() {
    const period = document.getElementById('newMemberPeriod').value;
    const date = document.getElementById('newMemberDate').value;

    const response = await fetch(`/api/attendance/new-members?period=${period}&date=${date}`, { headers: getHeaders() });
    const data = await response.json();

    document.getElementById('newMemberCount').textContent = `${data.count}ëª…`;

    const tbody = document.getElementById('newMemberList');
    tbody.innerHTML = data.members.map(m => `
        <tr>
            <td>${m.joined_at}</td>
            <td>${m.name}</td>
            <td>${m.phone}</td>
            <td>${m.first_attendance || '-'}</td>
        </tr>
    `).join('');
}
```

**After:**
```javascript
async function loadNewMembers() {
    const period = document.getElementById('newMemberPeriod').value;
    const date = document.getElementById('newMemberDate').value;

    const response = await fetch(`/api/attendance/new-members?period=${period}&date=${date}`, { headers: getHeaders() });
    const data = await response.json();

    // âœ… í†µê³„ ë°ì´í„° í‘œì‹œ
    document.getElementById('newMemberCount').textContent = `${data.count}ëª…`;
    document.getElementById('newMemberTotalAttendance').textContent = `${data.total_attendance}íšŒ`;
    document.getElementById('newMemberAvgAttendance').textContent = `${data.avg_attendance}íšŒ`;

    const tbody = document.getElementById('newMemberList');
    tbody.innerHTML = data.members.map((m, index) => {
        // âœ… ìˆœìœ„ ë°°ì§€ ìŠ¤íƒ€ì¼ ì ìš©
        let rankClass = 'rank-other';
        if (index === 0) rankClass = 'rank-1';
        if (index === 1) rankClass = 'rank-2';
        if (index === 2) rankClass = 'rank-3';

        return `
        <tr>
            <td><span class="rank-badge ${rankClass}">${index + 1}</span></td>
            <td>${m.name}</td>
            <td>${m.phone}</td>
            <td><strong>${m.attendance_count}íšŒ</strong></td>  <!-- âœ… ì¶œì„ íšŸìˆ˜ -->
            <td>${m.joined_at}</td>
            <td>${m.first_attendance || '-'}</td>
            <td>${m.last_attendance || '-'}</td>                 <!-- âœ… ìµœê·¼ ì¶œì„ì¼ -->
        </tr>
        `;
    }).join('');
}
```

#### 2-4. ê¸°ë³¸ íƒ­ ë³€ê²½ (lines 169, 177, 221)

**íƒ­ ë²„íŠ¼ (line 169):**
```html
<!-- Before -->
<button class="tab-btn" onclick="switchTab('waiting_status')">ëŒ€ê¸°í˜„í™©</button>
<button class="tab-btn active" onclick="switchTab('status')">ì¶œì„í˜„í™©</button>

<!-- After -->
<button class="tab-btn active" onclick="switchTab('waiting_status')">ëŒ€ê¸°í˜„í™©</button>  <!-- âœ… active ì¶”ê°€ -->
<button class="tab-btn" onclick="switchTab('status')">ì¶œì„í˜„í™©</button>               <!-- âœ… active ì œê±° -->
```

**íƒ­ ì»¨í…ì¸  (lines 177, 221):**
```html
<!-- Before -->
<div id="waiting_statusTab" class="tab-content">      <!-- ëŒ€ê¸°í˜„í™© íƒ­ -->
<div id="statusTab" class="tab-content active">       <!-- ì¶œì„í˜„í™© íƒ­ -->

<!-- After -->
<div id="waiting_statusTab" class="tab-content active">  <!-- âœ… active ì¶”ê°€ -->
<div id="statusTab" class="tab-content">                 <!-- âœ… active ì œê±° -->
```

## ë³€ê²½ ì‚¬í•­ ìš”ì•½

### ì‹ ê·œíšŒì› íƒ­ ê°œì„ 
| í•­ëª© | Before | After |
|------|--------|-------|
| **í†µê³„ ì¹´ë“œ** | ì‹ ê·œ ê°€ì… íšŒì› ìˆ˜ë§Œ í‘œì‹œ | ì‹ ê·œ ê°€ì… íšŒì›, ì´ ì¶œì„ íšŸìˆ˜, í‰ê·  ì¶œì„ íšŸìˆ˜ í‘œì‹œ |
| **í…Œì´ë¸” ì»¬ëŸ¼** | ê°€ì…ì¼ì‹œ, ì´ë¦„, ì „í™”ë²ˆí˜¸, ìµœì´ˆ ì¶œì„ì¼ | ìˆœìœ„, ì´ë¦„, ì „í™”ë²ˆí˜¸, ì¶œì„ íšŸìˆ˜, ê°€ì…ì¼, ìµœì´ˆ ì¶œì„ì¼, ìµœê·¼ ì¶œì„ì¼ |
| **ì •ë ¬ ê¸°ì¤€** | ê°€ì…ì¼ ê¸°ì¤€ (ìµœì‹ ìˆœ) | **ì¶œì„ íšŸìˆ˜ ê¸°ì¤€ (ë§ì€ ìˆœ)** âœ… |
| **ìˆœìœ„ í‘œì‹œ** | ì—†ìŒ | 1-3ìœ„ëŠ” ê¸ˆ/ì€/ë™ ë°°ì§€, ë‚˜ë¨¸ì§€ëŠ” ì¼ë°˜ ë°°ì§€ |

### ê¸°ë³¸ íƒ­ ë³€ê²½
| í•­ëª© | Before | After |
|------|--------|-------|
| **ê¸°ë³¸ ì„ íƒ íƒ­** | ì¶œì„í˜„í™© | **ëŒ€ê¸° í˜„í™©** âœ… |

## ê²°ê³¼

### ì‹ ê·œíšŒì› íƒ­ í™”ë©´

**í†µê³„ í‘œì‹œ:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì‹ ê·œ ê°€ì… íšŒì› â”‚  â”‚ ì´ ì¶œì„ íšŸìˆ˜   â”‚  â”‚ í‰ê·  ì¶œì„ íšŸìˆ˜ â”‚
â”‚     15ëª…       â”‚  â”‚     45íšŒ       â”‚  â”‚     3.0íšŒ      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ë¦¬ìŠ¤íŠ¸ í‘œì‹œ (ì¶œì„ìˆœ ì •ë ¬):**
```
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ìˆœìœ„â”‚  ì´ë¦„  â”‚   ì „í™”ë²ˆí˜¸   â”‚ì¶œì„ íšŸìˆ˜ â”‚   ê°€ì…ì¼   â”‚ ìµœì´ˆ ì¶œì„ì¼  â”‚ ìµœê·¼ ì¶œì„ì¼  â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ¥‡ â”‚ í™ê¸¸ë™ â”‚ 010-1234-5678â”‚   10íšŒ   â”‚ 2025-11-01 â”‚ 2025-11-02   â”‚ 2025-12-03   â”‚
â”‚ ğŸ¥ˆ â”‚ ê¹€ì² ìˆ˜ â”‚ 010-2345-6789â”‚    8íšŒ   â”‚ 2025-11-05 â”‚ 2025-11-06   â”‚ 2025-12-01   â”‚
â”‚ ğŸ¥‰ â”‚ ì´ì˜í¬ â”‚ 010-3456-7890â”‚    7íšŒ   â”‚ 2025-11-10 â”‚ 2025-11-11   â”‚ 2025-11-30   â”‚
â”‚  4 â”‚ ë°•ë¯¼ìˆ˜ â”‚ 010-4567-8901â”‚    5íšŒ   â”‚ 2025-11-15 â”‚ 2025-11-16   â”‚ 2025-11-28   â”‚
â”‚  5 â”‚ ìµœì§€ì€ â”‚ 010-5678-9012â”‚    3íšŒ   â”‚ 2025-11-20 â”‚ 2025-11-21   â”‚ 2025-11-25   â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ê¸°ë³¸ íƒ­

í™”ë©´ ì§„ì… ì‹œ **ëŒ€ê¸° í˜„í™© íƒ­**ì´ ìë™ìœ¼ë¡œ ì„ íƒë©ë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [ëŒ€ê¸°í˜„í™©*]  [ì¶œì„í˜„í™©]  [ê°œì¸ë³„ ì¶œì„]  [ì‹ ê·œíšŒì›]  [ì¶œì„ìˆœìœ„]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ì˜í–¥ ë²”ìœ„

### ìˆ˜ì •ëœ íŒŒì¼
1. âœ… `routers/attendance.py` - `/api/attendance/new-members` ì—”ë“œí¬ì¸íŠ¸
2. âœ… `templates/attendance.html` - ì‹ ê·œíšŒì› íƒ­ UI ë° ê¸°ë³¸ íƒ­ ì„¤ì •

### ì˜í–¥ë°›ëŠ” ê¸°ëŠ¥
- âœ… ì¶œì„ ì¡°íšŒ > ì‹ ê·œíšŒì› íƒ­
  - í†µê³„ ë°ì´í„° í‘œì‹œ
  - ì¶œì„ìˆœ ì •ë ¬
  - ìˆœìœ„ ë°°ì§€ í‘œì‹œ
- âœ… ì¶œì„ ì¡°íšŒ í™”ë©´ ì§„ì… ì‹œ ê¸°ë³¸ íƒ­

### ì˜í–¥ë°›ì§€ ì•ŠëŠ” ê¸°ëŠ¥
- âœ… ëŒ€ê¸° í˜„í™© íƒ­
- âœ… ì¶œì„í˜„í™© íƒ­
- âœ… ê°œì¸ë³„ ì¶œì„ íƒ­
- âœ… ì¶œì„ìˆœìœ„ íƒ­

## ê²°ë¡ 

**ì‹ ê·œíšŒì› íƒ­ì´ ì¶œì„í˜„í™© íƒ­ì²˜ëŸ¼ í’ë¶€í•œ ë°ì´í„°ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤:**

1. âœ… í†µê³„ ì¹´ë“œ 3ê°œ í‘œì‹œ (ì‹ ê·œ íšŒì› ìˆ˜, ì´ ì¶œì„, í‰ê·  ì¶œì„)
2. âœ… ì¶œì„ìˆœìœ¼ë¡œ ì •ë ¬ (ì¶œì„ íšŸìˆ˜ê°€ ë§ì€ ìˆœ)
3. âœ… ìˆœìœ„ í‘œì‹œ (1-3ìœ„ëŠ” ê¸ˆ/ì€/ë™ ë°°ì§€)
4. âœ… ìƒì„¸ ì •ë³´ í‘œì‹œ (ì¶œì„ íšŸìˆ˜, ê°€ì…ì¼, ìµœì´ˆ/ìµœê·¼ ì¶œì„ì¼)
5. âœ… ê¸°ë³¸ íƒ­ì´ "ëŒ€ê¸° í˜„í™©"ìœ¼ë¡œ ë³€ê²½

**ì‹ ê·œíšŒì›ì˜ ì¶œì„ í™œë™ì„ í•œëˆˆì— íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!**
