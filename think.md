# AI 코딩 어시스턴트 작업 원칙

## 핵심 원칙

### 1. 검증 우선 (Verify First)
- **모든 코드 수정 후 반드시 로컬 테스트를 수행한다**
- 프로덕션 배포 전 `uvicorn` 또는 개발 서버로 실행 가능 여부를 확인한다
- API 엔드포인트 변경 시 `curl` 또는 실제 요청으로 동작을 검증한다
- 빌드 오류가 없는지 확인한다

### 2. 점진적 변경 (Incremental Changes)
- 한 번에 하나의 기능만 수정한다
- 여러 파일을 동시에 수정하지 않는다
- 각 변경사항을 독립적으로 테스트한다
- 롤백이 쉽도록 작은 단위로 커밋한다

### 3. 영향 범위 분석 (Impact Analysis)
- 코드 수정 전 의존성을 파악한다
- Import 구조를 확인한다
- 다른 모듈에 미치는 영향을 예측한다
- 특히 `main.py`와 같은 진입점 파일은 신중히 다룬다

### 4. 오류 처리 (Error Handling)
- Try-catch로 예외를 감싸 시스템 전체가 멈추지 않도록 한다
- 로깅을 추가할 때는 실패해도 메인 로직에 영향이 없도록 한다
- 선택적 기능(Optional Feature)은 실패 시 우아하게 degradation 되도록 설계한다

### 5. 문서화 (Documentation)
- 변경 이유를 명확히 기록한다
- 커밋 메시지는 구체적으로 작성한다
- 복잡한 로직에는 주석을 추가한다
- 사용자에게 변경사항을 명확히 전달한다

## 실패 사례 분석 (이번 세션)

### 문제 1: 검증 없는 배포
**발생**: `Request` 파라미터 추가 후 즉시 push
**결과**: 시스템 전체 다운
**원인**: 로컬 테스트 없이 배포
**교훈**: 반드시 로컬에서 서버를 띄워 테스트한 후 배포

### 문제 2: 의존성 누락
**발생**: `debug` 라우터를 `main.py`에 include했으나 import 누락
**결과**: `NameError: name 'debug' is not defined`
**원인**: 파일 생성과 import 구조 불일치
**교훈**: 새 모듈 추가 시 import 체인 전체를 확인

### 문제 3: 문법 오류
**발생**: Docstring 중복으로 인한 `SyntaxError`
**결과**: Python 파일 파싱 실패
**원인**: 파일 일부만 수정하면서 구조 파악 실패
**교훈**: 파일 전체 구조를 이해하고 수정

## 올바른 작업 흐름

```
1. 요구사항 이해
   ↓
2. 영향 범위 파악
   ↓
3. 코드 수정
   ↓
4. 로컬 테스트 (uvicorn/npm run dev)
   ↓
5. 테스트 성공 확인
   ↓
6. Git commit
   ↓
7. Git push
   ↓
8. 배포 요청
```

## 체크리스트

### 코드 수정 전
- [ ] 변경할 파일의 전체 구조를 파악했는가?
- [ ] 의존성 관계를 확인했는가?
- [ ] 다른 파일에 미치는 영향을 분석했는가?

### 코드 수정 후
- [ ] 문법 오류가 없는가?
- [ ] Import가 올바른가?
- [ ] 로컬에서 서버가 정상 실행되는가?
- [ ] API 엔드포인트가 정상 응답하는가?

### 배포 전
- [ ] 모든 테스트를 통과했는가?
- [ ] 롤백 계획이 있는가?
- [ ] 사용자에게 변경사항을 설명했는가?

## 긴급 상황 대응

### 시스템 다운 시
1. 즉시 이전 커밋으로 롤백
2. 문제 원인 파악
3. 로컬에서 수정 및 검증
4. 재배포

### 원인 불명 오류 시
1. 로그 확인
2. 최근 변경사항 검토
3. 단계별 롤백 테스트
4. 최소 재현 케이스 작성

## 사용자 커뮤니케이션

### 변경 전
- 무엇을 왜 바꾸는지 설명
- 예상되는 영향 범위 공유
- 테스트 계획 제시

### 변경 후
- 실제 변경 내용 요약
- 검증 결과 공유
- 다음 단계 안내

### 문제 발생 시
- 즉시 상황 공유
- 복구 계획 제시
- 재발 방지 대책 설명

## 결론

**"빠르게 실패하고, 안전하게 복구하라"**

- 완벽한 코드는 없다
- 실수는 발생한다
- 중요한 것은 빠른 감지와 복구
- 그리고 같은 실수를 반복하지 않는 것
