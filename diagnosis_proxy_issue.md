# 외부 대기자 등록 시 프록시 서버 로그 미수신 원인 분석

문제 상황: 태블릿에 설치된 Proxy Server가 외부(다른 기기) 대기자 등록 시 반응하지 않음 (로그 없음).

## 주요 원인 분석

대기자 등록 기기(Sender)에서 보낸 요청이 태블릿 프록시(Receiver)에 도달하지 못해 발생하는 현상입니다. 가장 유력한 원인 3가지를 정리했습니다.

### 1. 프록시 IP 설정 문제 (가장 유력)

*   **현상**: 외부 기기가 태블릿의 IP가 아닌, 자기 자신(`localhost`)에게 요청을 보내고 있을 가능성이 높습니다.
*   **코드 분석 결과**: `usePrinter.ts` 코드를 보면 `settings.printer_proxy_ip` 값이 없으면 기본값으로 `'localhost'`를 사용합니다.
    ```typescript
    // usePrinter.ts 내부 로직
    proxyIp: settings.printer_proxy_ip || 'localhost',
    ```
*   **확인 방법**:
    1.  슈퍼어드민 > 매장 설정 > 프린터 설정으로 이동합니다.
    2.  **"프린터 프록시 IP"** 항목에 **태블릿의 실제 IP 주소**(예: 192.168.0.15)가 정확히 입력되어 있는지 확인합니다.
    3.  입력되어 있지 않다면 외부 기기는 `localhost:8000`으로 요청을 보내게 되어, 태블릿에는 아무런 기록이 남지 않습니다.

### 2. Mixed Content (보안 차단) 문제

*   **현상**: 외부 기기가 Vercel 등 HTTPS(보안 연결) 환경에서 실행 중이라면, 브라우저가 HTTP(비보안)인 로컬 프록시 서버로의 요청을 **자동으로 차단**합니다.
*   **원인**: 최신 브라우저 보안 정책상 `https://...` 페이지에서 `http://192.168.x.x:8000`으로의 AJAX 요청(fetch)은 "Mixed Content"로 간주되어 전송 자체가 되지 않습니다.
*   **확인 방법**: 외부 기기의 브라우저 개발자 도구(F12) > 콘솔(Console) 탭을 확인합니다.
    *   `Mixed Content: The page at 'https://...' was loaded over HTTPS, but requested an insecure resource 'http://...'` 와 같은 빨간색 에러 메시지가 있는지 확인합니다.
*   **해결책**:
    *   **방법 A**: 외부 기기에서 주소창 옆의 자물쇠 아이콘 > 사이트 설정 > **"안전하지 않은 콘텐츠" 허용** (Chrome 기준).
    *   **방법 B**: (권장) Vercel이 아닌 로컬 네트워크(HTTP) 환경에서 외부 기기를 접속하여 테스트.

### 3. 네트워크 격리 (Network Isolation)

*   **현상**: 두 기기가 물리적으로는 같은 와이파이에 연결된 것처럼 보이지만, 공유기 설정에 의해 서로 통신이 차단된 경우입니다.
*   **원인**: "게스트 네트워크(Guest WiFi)"를 사용하거나, 공유기의 "AP 격리(AP Isolation)" 기능이 켜져 있으면 기기 간 통신(Ping 등)이 불가능합니다.
*   **확인 방법**:
    *   두 기기가 정확히 **동일한 와이파이 이름(SSID)**에 연결되어 있는지 확인합니다.
    *   5Ghz/2.4Ghz 대역이 다를 경우 일부 공유기에서는 통신이 안 될 수 있습니다.

## 요약 및 조치 가이드

| 우선순위 | 점검 항목 | 조치 사항 |
| :--- | :--- | :--- |
| **1** | **프록시 IP 설정** | 매장 설정에서 **`printer_proxy_ip`**에 태블릿 IP가 입력되었는지 확인 및 저장. |
| **2** | **HTTPS 차단** | 외부 기기 개발자 도구 콘솔 확인. 에러 시 브라우저 보안 설정 해제. |
| **3** | **네트워크** | 두 기기가 동일한 공유기(동일 IP 대역)인지 확인. |

위 3가지 중 1번(설정 누락)일 가능성이 가장 높습니다. 설정을 확인해 보시기 바랍니다.
